<h1>Application For <%= @application.name %></h1>

<%= @application.street_address %><br>
<%= @application.city %>, 
<%= @application.state %> 
<%= @application.zipcode %><br>

<% if @application.status == "Pending" %>
<h3>Reason <%= @application.name %> would be a good home</h3>
<%= @application.reason_for_adoption %>
<% end %>

<h4>Application Status</h4>
<%= @application.status %>


<h4>Pets Applied For</h4>
<% @pets.each do |pet| %>
  <%= link_to "#{pet.name}", "/pets/#{pet.id}" %>
  <p>Approval Status: <%= pet.application_status(@application) %></p>
<% end %>

<% if @application.status == "In Progress" %>
  <h3> Add a Pet to this Application </h3>
  <%= form_with url: "/applications/#{@application.id}", method: :get, local: true do |g| %>
    <%= g.label :search %>
    <%= g.text_field :search, value: params[:search] %>
    <%= g.submit "Search" %>
  <% end %>
  <% if @search_results %>
    <h3> Search Results </h3>
    <ul>
      <% @results.each do |result| %>
        <li>
          <p>
            <%= result.name %>
            <%= button_to "Adopt this Pet", "/applications/#{@application.id}/pet_applications" %>
          </p>
        </li>
      <% end %>
    </ul>
  <% else %>
    <p>No results found</p>
  <% end %>
  <% if !@application.pets.empty? %>
    <%= form_with url: "/applications/#{@application.id}", method: :patch, local: true do |form| %>
      <%= form.label :reason_for_adoption, "Please explain why you would be a good home" %>
      <%= form.text_area :reason_for_adoption %><br>
      <%= form.submit "Submit" %>
    <% end %>
  <% end %>
<% end %>


